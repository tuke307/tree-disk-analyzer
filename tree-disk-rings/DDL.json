{
    "general": {
        "demo_title": "Tree Ring Detection Over Wood Slices",
        "requirements": "docker"
    },
    "build": {
            "url": "git@github.com:hmarichal93/dendrometria-ipol",
            "rev": "origin/main",
            "dockerfile": ".ipol/Dockerfile"
    },
    "inputs": [
        {
            "description": "input",
            "max_pixels": "3000*3000",
            "dtype": "x8i",
            "ext": ".png",
            "type": "image",
            "control": "dots",
            "max_dots": 1
        }
    ],
    "params": [
         {
            "id": "sigma",
            "label": "sigma",
            "comments": "Noise standard deviation",
            "type": "range",
            "values": {
                "default":2,
                "max": 10,
                "min": 1,
                "step": 0.5
            }
        },
        {
            "label" : "<b>Advanced parameters</b>",
            "type" : "label",
            "visible": "params.options=='1'"
        },
        {
            "id": "options",
            "label": "Show advanced parameters",
            "type": "checkbox",
            "default_value": false
        },
        {
            "id":"nr",
            "label":"Nr",
            "comments": "Define the radial sampling frecuency",
            "type":"range",
            "values":{
                "default":360,
                "max":720,
                "min":2,
                "step":10
            },
            "visible": "params.options=='1'"
        },
        {
            "id": "th_low",
            "label": "Gradient threshold low",
            "type": "range",
            "values": {
                "default": 5.0,
                "max": 50,
                "min": 0.0,
                "step": 0.1
            },
            "visible": "params.options=='1'"
        },
        {
            "id": "th_high",
            "label": "Gradient threshold high",
            "type": "range",
            "values": {
                "default": 20.0,
                "max": 50,
                "min": 0.0,
                "step": 0.1
            },
            "visible": "params.options=='1'"
        },
        {
            "id": "output_zoom_factor",
            "label": "ZOOM factor to render sub-pixel output",
            "type": "range",
            "values": {
                "default": 2,
                "max": 10,
                "min": 1,
                "step": 1
            },
            "visible": "params.options=='1'"
        },
        {
            "id": "hsize",
            "label": "heigh size",
            "type": "range",
            "values": {
                "default": 1000,
                "max": 3000,
                "min": 0,
                "step": 1
            },
            "visible": "params.options=='1'"
        },
        {
            "id": "wsize",
            "label": "width size",
            "type": "range",
            "values": {
                "default": 1000,
                "max": 3000,
                "min": 0,
                "step": 1
            },
            "visible": "params.options=='1'"
        }
    ],
    "results": [
        {
            "contents": {
                "Output": {
                    "img": "output.png"
                },
                "preprocessing": {
                    "img": "preprocessing.png"
                },
                "edges": {
                    "img": "edges.png"
                },
                "filter": {
                    "img": "filter.png"
                },
                "chains": {
                    "img": "chains.png"
                },
                "connect": {
                    "img": "connect.png"
                },
                "post processing": {
                    "img": "postprocessing.png"
                }
            },
            "type": "gallery",
            "label": "<b>Intermediary results</b>"
        },
        {
            "contents": {
                "json file": "labelme.json"
            },
            "label": "You can download the Json file containing rings positions (labelme format)",
            "type": "file_download"
        },
        {
            "contents": "stdout.txt",
            "label": "<p>Output</p>",
            "type": "text_file"
        }
    ],
    "archive": {
        "enable_reconstruct": true,
        "files": {
            "input_0.png": "Input",
            "output.png": "Output",
            "preprocessing.png": "preprocessing",
            "edges.png": "edges",
            "filter.png": "filter",
            "chains.png": "chains",
            "connect.png": "grouping_chains",
            "postprocessing.png": "post processing"

        },
        "info": {
            "run_time": "run time"
        }
    },
    "run": "$bin/.ipol/run.sh $input_0 $sigma $nr $th_low $th_high $hsize $wsize $bin $HOME"
}